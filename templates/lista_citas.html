{% extends 'base.html' %}

{% block content %}





{% if tipo == "pendientes" %}
<h2 class="display-5 text-center"> Lista de citas </h2>

{% else %}
<div class="d-flex justify-content-between align-items-center mb-3">

    <!-- Columna izquierda vacÃ­a para permitir el centrado -->
    <div style="width:180px;"></div>

    <!-- TÃ­tulo centrado -->
    <h2 class="display-5 text-center flex-grow-1 m-0">
        Citas completadas
    </h2>

    <!-- Tarjeta a la derecha -->
    <div class="card p-0 text-center" style="width: 280px;">
        <small class="text-muted">Ganancias</small>
        <h4 class="mb-0">${{ total_completadas }}</h4>
    </div>
</div>

{% endif %}



{% if lista and not tipo == "pendientes" %}
<div id="filtros-flotantes" class="d-none d-md-block">
    <div class="d-flex flex-column text-end" style="width: 200px; gap: 14px;">
        <button class="btn btn-outline-primary btn-sm">Filtrar por semana</button>
        <button class="btn btn-outline-primary btn-sm">Filtrar por mes</button>
        <button class="btn btn-outline-primary btn-sm">Filtrar personalizado</button>
    </div>
</div>

{% for cita in lista %}

    <div class="row justify-content-center align-items-start mb-3">
        <!-- COLUMNA PRINCIPAL CENTRADA -->
        <div class="col-12 col-md-8 col-lg-5">
            <section class="card card-body">
                <h2> Nombre: {{ cita.nombre_clienta }}</h2>

                <p> Servicio: {{ cita.servicio }}</p>
                <p> Precio: ${{ cita.precio}} </p>
                <p> DÃ­a: {{ cita.fecha }}</p>
                <p> Hora: {{ cita.hora|time:"H:i" }}</p>
                <p> Comentario: <br>{{ cita.comentario|default:"(sin comentario)" }}</p>

                <p>Estado: {{ cita.estado|yesno:"realizada,pendiente" }}</p>

                <div class="d-flex gap-2">

                    {% if tipo == "pendientes" %}
                    <form action="{% url 'completar_cita' cita.id %}" method="POST" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success">
                            âœ… Completar
                        </button>
                    </form>

                    <a href="{% url 'editar_cita' cita.id %}" class="btn btn-warning">
                        âœï¸ Editar
                    </a>
                    {% endif %}

                    <form action="{% url 'eliminar_cita' cita.id %}" method="POST" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger"
                                onclick="return confirmarEliminacion()">
                            ğŸ—‘ï¸ Eliminar
                        </button>
                    </form>

                </div>
            </section>
        </div>
    </div>

{% endfor %}


{% else %}
<p>No hay citas registradas aÃºn.</p>
</section>
{% endif %}



{% endblock %}