{% extends 'base.html' %}

{% block content %}





{% if tipo == "pendientes" %}
<h2 class="display-5 text-center"> Lista de citas </h2>

{% else %}
<div class="d-flex justify-content-between align-items-center mb-3">

    <!-- Columna izquierda vacÃ­a para permitir el centrado -->
    <div style="width:180px;"></div>

    <!-- TÃ­tulo centrado -->
    <h2 class="display-5 text-center flex-grow-1 m-0">
        Citas completadas
    </h2>

    <!-- Tarjeta a la derecha -->
    <div class="card p-2" style="width: 180px;">
        <small class="text-muted">Ganancias</small>
        <h4 class="mb-0">${{ total_completadas }}</h4>
    </div>
</div>
{% endif %}


{% if lista %}
{% for cita in lista %}
    <div class="row justify-content-center">
        <div class="col-12 col-md-8 col-lg-5">
            <section class="card card-body mb-3">
                <h2> Nombre: {{ cita.nombre_clienta }}</h2>

                <p> Servicio: {{ cita.servicio }}</p>
                <p> Precio: ${{ cita.precio}} </p>
                <p> DÃ­a: {{ cita.fecha }}</p>
                <p> Hora: {{ cita.hora|time:"H:i" }}</p>
                <p> Comentario: <br>{{ cita.comentario|default:"(sin comentario)" }}</p>

                <p>Estado: {{ cita.estado|yesno:"realizada,pendiente" }}</p>
                <div class="d-flex gap-2">

                    {% if tipo == "pendientes" %}
                    <!-- BotÃ³n verde (completar) -->
                    <form action="{% url 'completar_cita' cita.id %}" method="POST" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success">
                            âœ… Completar
                        </button>
                    </form>

                    <!-- BotÃ³n amarillo (editar) -->
                    <a href="{% url 'editar_cita' cita.id %}" 
                    class="btn btn-warning">
                        âœï¸ Editar
                    </a>
                    {% endif %}

                    <!-- BotÃ³n rojo (eliminar) -->
                    <form action="{% url 'eliminar_cita' cita.id %}" method="POST" class="d-inline">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger"
                                onclick="return confirmarEliminacion()">
                            ğŸ—‘ï¸ Eliminar
                        </button>
                    </form>

                </div>
            </section>
        </div>
    </div>
{% endfor %}

<script>
    function confirmarEliminacion() {
        return confirm("Â¿EstÃ¡s seguro de que querÃ©s eliminar esta cita?");
    }
</script>

{% else %}
<p>No hay citas registradas aÃºn.</p>
</section>
{% endif %}



{% endblock %}